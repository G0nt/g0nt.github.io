<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<title>RSA - Recovering A Full Pem Private Key</title>

<link rel='canonical' href='https://demo.stack.jimmycai.com/p/quickstyle/'>
<link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="pddp.png" />

<script async src="https://www.googletagmanager.com/gtag/js?id=G-7ZZVSZXS4P"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-7ZZVSZXS4P', { 'anonymize_ip': false });
}
</script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
        <figure class="site-avatar">
            <a href="index.html">
            
                    <img src="pddp.png" width="300"
                        height="200" class="site-logo" loading="lazy" alt="Avatar">
                
            
            </a>
            
                <span class="emoji">üëë</span>
            
        </figure>
        
    
    
    <div class="site-meta">
        <h1 class="site-name"><a href="index.html">G0nt</a></h1>
        <h2 class="site-description">French Student, Cybersecurity enthusiast</h2>
    </div>
</header><ol class="social-menu">
        
            <li>
                <a 
                    href='https://app.hackthebox.com/profile/921389'
                    target="_blank"
                    title="htb"
                    rel="rm"
                >
                    
                    
                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="m22.51 6.457l.001-.013a.888.888 0 0 0-.271-.638l-.027-.024c-.019-.016-.037-.033-.057-.048a.695.695 0 0 0-.06-.04l-.029-.02l-9.61-5.547a.891.891 0 0 0-.922.004L1.933 5.674l-.03.02l-.023.014l-.02.015a.877.877 0 0 0-.147.134l-.003.003a.887.887 0 0 0-.221.584v.014l-.001.027v11.07c0 .328.18.63.469.784l9.599 5.542l.023.011a.875.875 0 0 0 .166.07l.04.01a.88.88 0 0 0 .072.015c.012.002.023.005.035.006a.835.835 0 0 0 .216 0c.012-.001.023-.004.035-.006a.9.9 0 0 0 .072-.014l.04-.012a.895.895 0 0 0 .064-.022a.913.913 0 0 0 .102-.047l.023-.011l9.599-5.542a.889.889 0 0 0 .469-.784V6.478zM5.255 6.082l6.537-3.774a.418.418 0 0 1 .418 0l6.537 3.774a.418.418 0 0 1 0 .725l-6.537 3.774a.418.418 0 0 1-.418 0L5.254 6.807a.418.418 0 0 1 0-.725m5.614 14.345a.417.417 0 0 1-.626.361l-6.524-3.766a.417.417 0 0 1-.209-.361V9.127a.417.417 0 0 1 .626-.361l6.524 3.766a.417.417 0 0 1 .209.362zm9.623-3.766a.417.417 0 0 1-.209.36l-6.524 3.767a.417.417 0 0 1-.626-.36v-7.533c0-.15.08-.287.209-.362l6.524-3.766a.417.417 0 0 1 .626.36z"/></svg>

                </a>
            </li>
        
            <li>
                <a 
                    href='https://www.root-me.org/G0nt'
                    target="_blank"
                    title="rm"
                    rel="rm"
                >
                    
                    
                        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Root Me</title><path d="M10.865 0a.972.972 0 00-.943.764c-4.205.953-7.285 4.738-7.285 9.125 0 1.249.248 2.498.734 3.642a.94.94 0 00-.287.686c0 .429.277.782.658.916v3.756c0 .066.019.134.057.191l.21.143 2.852 2.011v2.403c0 .2.161.363.362.363h9.535c.2 0 .363-.163.363-.363v-2.403l2.86-2.011.21-.153a.345.345 0 00.057-.191v-3.785a.957.957 0 00.6-.887.976.976 0 00-.246-.648 9.024 9.024 0 00.761-3.66c0-.449-.029-.898-.095-1.327 0-.028-.01-.057-.01-.086-.582-3.785-3.45-6.893-7.227-7.722a.96.96 0 10-1.145 1.143v3.519c0 .057.03.114.077.152.028.02.067.03.105.03.02 0 .048 0 .067-.01l1.41-.535c.095.143.238.239.41.287v1.658c-.715.877-1.6 1.67-2.545 2.375l-1.078-2.498a.732.732 0 00-.4-1.346.735.735 0 000 1.469h.039l1.125 2.603c-.658.477-1.335.906-2.002 1.297l-3.205-.963a.157.157 0 00-.114.01l-.955.371a.735.735 0 10.145.44c0-.029-.01-.058-.01-.086l.897-.354 2.793.84a33.433 33.433 0 01-4.874 2.23l-.17.06a.92.92 0 00-.554-.183H4.02a8.67 8.67 0 01-.678-3.367c0-.572.057-1.134.162-1.677h4.185a.733.733 0 100-.38l-4.1-.001c.773-3.137 3.252-5.645 6.456-6.389a.974.974 0 00.82.467.96.96 0 00.963-.963.96.96 0 00-.963-.963zm2.23.496c.134 0 .249.057.335.143.076.085.125.19.125.314a.466.466 0 01-.201.381.422.422 0 01-.266.086.452.452 0 01-.46-.457c0-.258.21-.467.468-.467zm-2.22.01a.467.467 0 110 .934.467.467 0 010-.934zm3.05.933a8.448 8.448 0 012.823 1.202c-.01 1.41-.552 2.708-1.41 3.88V5.34a.726.726 0 00.543-.705c0-.4-.325-.735-.735-.735a.739.739 0 00-.724.735c0 .028.01.047.01.066l-1.164.438v-3.24a.926.926 0 00.658-.46zM10.942 2.9a.735.735 0 00-.734.697l-1.459.533a.195.195 0 00-.133.182v.923H7.441a.726.726 0 00-.705-.543.735.735 0 000 1.47c.344 0 .62-.231.705-.546h1.366a.19.19 0 00.19-.19v-.982l1.286-.476c.124.238.372.4.649.4.4 0 .734-.324.734-.734a.726.726 0 00-.725-.735zm6.465.228a8.743 8.743 0 013.157 5.475c-.048 4.777-8.372 7.723-8.458 7.752-.019.01-.067.018-.105.037-.105-.02-.21-.038-.324-.057-.076-.02-.162-.03-.239-.049-.123-.019-.247-.047-.37-.076-.02-.01-.05-.008-.069-.008l-.143-.03c-.057-.009-.114-.029-.171-.038-.134-.029-.267-.056-.391-.094-.238-.057-.466-.124-.695-.182-.22-.066-.449-.124-.659-.191h-.02a6.686 6.686 0 01-.466-.152.93.93 0 00-.152-.047 2.67 2.67 0 00-.211-.069 2.851 2.851 0 01-.342-.123h-.01a5.97 5.97 0 01-.459-.171c-.143-.058-.266-.105-.361-.143-.095-.048-.18-.077-.229-.106-.057-.028-.085-.037-.085-.037s.018.029.056.067c.038.047.096.113.182.19.076.075.18.171.304.267.124.095.268.2.42.304h.01c-.057.191-.096.402-.096.612 0 1.096.896 1.992 1.993 1.992a1.99 1.99 0 001.859-1.287l.297.03c.172.009.334.009.486.009.01 0 .018.008.028.008l1.61 1.64c.41.41 1.05.477 1.526.163l2.518-1.41a.795.795 0 00.363-.659v-2.898c.973-.773 1.85-1.69 2.422-2.729a8.15 8.15 0 01-.602 2.147h-.085a.96.96 0 00-.334 1.859v3.508l-3.002 2.117a.37.37 0 00-.155.297v2.021a.21.21 0 01-.209.21H15.08a.212.212 0 01-.21-.21v-.724c0-.19-.134-.364-.325-.383a.367.367 0 00-.4.363v.752c0 .115-.095.211-.21.211h-1.363a.212.212 0 01-.209-.21v-1.116c0-.19-.133-.362-.324-.38a.367.367 0 00-.402.36v1.145c0 .114-.095.21-.21.21h-1.363a.212.212 0 01-.209-.21v-.742c0-.19-.133-.364-.324-.383a.367.367 0 00-.4.363v.752c0 .115-.097.211-.211.211H7.805a.212.212 0 01-.21-.21v-2.022a.366.366 0 00-.154-.295L4.447 18.64v-3.547a.96.96 0 00.545-1.05c.382-.133 3.29-1.171 6.15-2.954 3.872-2.413 6.016-5.15 6.264-7.963zM4.046 13.77a.464.464 0 01.459.467.458.458 0 01-.066.228.417.417 0 01-.382.219.5.5 0 01-.305-.114.472.472 0 01-.162-.343.465.465 0 01.457-.457zm15.868 0a.477.477 0 01.467.466.67.67 0 01-.113.268.481.481 0 01-.364.18.468.468 0 01-.334-.143.463.463 0 01-.123-.314c0-.2.124-.373.305-.43a.445.445 0 01.162-.027zm-11.68 2.287c.363.362 1.24 1.012 2.184 1.03a1.258 1.258 0 01-1.908 0 1.228 1.228 0 01-.295-.81c0-.076.01-.144.02-.22zm.477.228c.22.096.447.191.685.268a8.254 8.254 0 010 0 11.414 11.414 0 01-.685-.268zm3.242 2.795c-.01 0-.02 0-.03.01-.009 0-.019.01-.019.01-.01 0-.018.01-.027.01-.01 0-.02.007-.03.017-.009 0-.01.01-.019.01l-.02.02-.017.019-.773.963a.275.275 0 00.218.447.287.287 0 00.221-.104l.01-.01a.7.7 0 011.095 0l.01.01a.283.283 0 00.39.047.276.276 0 00.048-.39l-.781-.953c-.01-.01-.02-.02-.02-.03l-.018-.02c-.01 0-.01-.009-.02-.009-.009-.01-.019-.008-.028-.018-.01 0-.018-.01-.028-.01-.01 0-.02-.01-.02-.01-.009 0-.02 0-.029-.009H11.953z"></path></svg>
                    
                </a>
            </li>

        
    </ol><ol class="menu" id="main-menu">
    
    
    
    <li  class='current' >
        <a href='index.html' >
            
            
            
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z"/>
<polyline points="5 12 3 12 12 3 21 12 19 12" />
<path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
<path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>

            <span>Home </span>
        </a>
    </li>
    
    <div class="menu-bottom-section">
        
        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z"/>
<circle cx="8" cy="12" r="2" />
<rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z"/>
<circle cx="16" cy="12" r="2" />
<rect x="2" y="6" width="20" height="12" rx="6" />
</svg>

                <span>Dark Mode</span>
            </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
           


        </div>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#-description">üìù Description</a></li>
    <li><a href="#-recon">üîé Exploitation</a>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="">
                <img src="img6.png"
                        width="500" 
                        height="156" 
                        loading="lazy"
                        alt="img" />
                
            </a>
        </div>
    

    <div class="article-details">
    
        <header class="article-category">
        
            <a href="" style="background-color: #00eded; color: #000;">
                Crypto
            </a>
        
            <a href="" style="background-color: #5c00cc; color: #fff;">
                RSA
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="">RSA - Recovering A Full Pem Private Key</a>
        </h2>
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 22, 2024</time>
            </div>
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>

                <time class="article-time--reading">
                    5 minutes read
                </time>
            </div>
        
    </footer>
    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="-description">üìù Description</h2>
<p>Alice a perdu une partie de sa cl√© priv√©e ... d√©chiffrez le flag √† partir de la partie restante.</p>
<h2 id="-recon">üîé Exploitation</h2>
<p>Comme dit dans l'√©nonc√© du challenge, nous poss√©dons une cl√© priv√©e incompl√®te/corrompue au format PEM et un fichier flag.enc , nous allons travailler sur celle ci au format hexad√©cimal puis l'analyser <br> Partie de la cl√© restante au format pem :</p>
<div class="highlight"><div class="chroma">
    <table class="lntable"><tr><td class="lntd">
    <pre tabindex="0" class="chroma"><code><span class="lnt">1
    </span></code></pre></td>
    <td class="lntd">
    </span></span><span class="line"><span class="cl"><span class="p"><span class="kr">---------------</span><span class="nt">+LUJtSCo5IUbFMGufwzt7cYgy9emLl9blJifPQKCAQA4oKG6h+RSa0N+p3I5 <br>
        njsPDcUVi8mfb7fJNis6T/jlWSGQMGeaNE/qhI/tlOc7oGCuU9q2tujA+i2dwcgy <br>
        yNnzb5CQ2wAE9awZhBAg92E2APu1mDJgU5cl72QzpYVQymp8mWk/LS9poVUcxNUC <br>
        7Hx121sSDq0AFMKjVF8BeZ7LxCbTo7SAR007qRQOMK3QW7bEJPmozXocvshmW6lt <br>
        1Enkd3LxK86LJ4gchW/w81XithEtBORVBOjhSr+x+5tF+7if0OQvAfQlFoot9eY5 <br>
        HAueh/zKNnyGCl2mt4RlIBre71UCQPj4oJEO1G4lZHxXOGYkPlJQv09klhUtcqHG <br>
        lOlhAoIBADBoO5aR+b1LwN5y/VErkFvcYb7WjWn9cwD9ybNNoM7/H+JY8KPimBE9 <br>
        TtPUQqUvaa2qDfV5szwSseZdl5ku6ue5ZzccXPIvo5M4k8YKKNheXlhTfDQFxZM6 <br>
        Le7urY8tXDabHf9fxGmKrRP4g3CXQbNmBrerNHm00QwAd3DANYePu5E5Py/HC6oI <br>
        Le7urY8tXDabHf9fxGmKrRP4g3CXQbNmBrerNHm00QwAd3DANYePu5E5Py/HC6oI <br>
        1jKurpsXDxFh3j2dLcALAqTVDXUxUi0</span><span class="kr">---------------</span></span>
    </span></span></code></pre></td></tr></table>
    </div>
    </div><p>Mettons la au format hex :</p>
    <div class="highlight"><div class="chroma">
    <table class="lntable"><tr><td class="lntd">
    <pre tabindex="0" class="chroma"><code><span class="lnt">1
    </span></code></pre></td>
    <td class="lntd">
    <pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">f8b509b520a8e4851b14c1ae7f0cededc620cbd7a62e5f5b94989f3d0282010038a0a1ba87e4526b437ea772399e3b0f0dc5158bc99f6fb7c9362b3a4ff8e559219030679a344fea848fed94e73ba060ae53dab6b6e8c0fa2d9dc1c832c8d9f36f9090db0004f5ac19841020f7613600fbb5983260539725ef6433a58550ca6a7c99693f2d2f69a1551cc4d502ec7c75db5b120ead0014c2a3545f01799ecbc426d3a3b480474d3ba9140e30add05bb6c424f9a8cd7a1cbec8665ba96dd449e47772f12bce8b27881c856ff0f355e2b6112d04e45504e8e14abfb1fb9b45fbb89fd0e42f01f425168a2df5e6391c0b9e87fcca367c860a5da6b78465201adeef550240f8f8a0910ed46e25647c573866243e5250bf4f6496152d72a1c694e9610282010030683b9691f9bd4bc0de72fd512b905bdc61bed68d69fd7300fdc9b34da0ceff1fe258f0a3e298113d4ed3d442a52f69adaa0df579b33c12b1e65d97992eeae7b967371c5cf22fa3933893c60a28d85e5e58537c3405c5933ae3dc85acd45802c541b135418cabb555790afc209aa68b5935198e972cd8af6bec84a06d1f4b1d0dd19134a98bbcdc34e2887c58af3bbc8d64e6bfc71ce614f64e5fd5812661d3b53f0af3894fe41bc512bc12eca8b9bf8e07dfdef064553ccb2deeeead8f2d5c369b1dff5fc4698aad13f883709741b36606b7ab3479b4d10c007770c035878fbb91393f2fc70baa08d632aeae9b170f1161de3d9d2dc00b02a4d50d7531522d</span>
    </span></span></code></pre></td></tr></table>
    </div>
    </div><p>Elle nous r√©v√©le un delimiter de <strong>02820100</strong>, 3 parties s√©parent cette partie de cl√© <br>Il se compose de cette facon :</p>
    <div class="highlight"><div class="chroma">
        <table class="lntable"><tr><td class="lntd">
        <pre tabindex="0" class="chroma"><code><span class="lnt">1
        </span></code></pre></td>
        <td class="lntd">
        <span class="nx">02</span> indique que la structure suivante est un entier <br>
        <span class="k">82</span> indique que la longueur de l'entier est cod√©e sur deux octets <br>
        <span class="o">01 00</span> sont les valeurs hexad√©cimales de la longueur, soit 256 en d√©cimal <br>
            Cela signifie que l'entier qui suit a une longueur de 256 octets, soit 2048 bits</span>
        </span></span></code></pre></td></tr></table>
        </div>
        </div>
    <p> <img src="img7.png"
        width="1428"
        height="405"
        loading="lazy"
        class="gallery-image" 
        data-flex-grow="121"
        data-flex-basis="392px"></p>
        <p>On a donc :</p>
    <div class="highlight"><div class="chroma">
    <table class="lntable"><tr><td class="lntd">
    <pre tabindex="0" class="chroma"><code><span class="lnt">1
    </span></code></pre></td>
    <td class="lntd">
    </span></span><span class="line"><span class="cl"><span class="p"><span class="kr">1er partie :</span> f8b509b520a8e4851b14c1ae7f0cededc620cbd7a62e5f5b94989f3d <br> <span class="kr">2em partie :</span> 38a0a1ba87e4526b437ea772399e3b0f0dc5158bc99f6fb7c9362b3a4ff8e559219030679a344fea848fed94e73ba060ae53dab6b6e8c0fa2d9dc1c832c8d9f36f9090db0004f5ac19841020f7613600fbb5983260539725ef6433a58550ca6a7c99693f2d2f69a1551cc4d502ec7c75db5b120ead0014c2a3545f01799ecbc426d3a3b480474d3ba9140e30add05bb6c424f9a8cd7a1cbec8665ba96dd449e47772f12bce8b27881c856ff0f355e2b6112d04e45504e8e14abfb1fb9b45fbb89fd0e42f01f425168a2df5e6391c0b9e87fcca367c860a5da6b78465201adeef550240f8f8a0910ed46e25647c573866243e5250bf4f6496152d72a1c694e961 <br> <span class="kr">3em partie :</span> 30683b9691f9bd4bc0de72fd512b905bdc61bed68d69fd7300fdc9b34da0ceff1fe258f0a3e298113d4ed3d442a52f69adaa0df579b33c12b1e65d97992eeae7b967371c5cf22fa3933893c60a28d85e5e58537c3405c5933ae3dc85acd45802c541b135418cabb555790afc209aa68b5935198e972cd8af6bec84a06d1f4b1d0dd19134a98bbcdc34e2887c58af3bbc8d64e6bfc71ce614f64e5fd5812661d3b53f0af3894fe41bc512bc12eca8b9bf8e07dfdef064553ccb2deeeead8f2d5c369b1dff5fc4698aad13f883709741b36606b7ab3479b4d10c007770c035878fbb91393f2fc70baa08d632aeae9b170f1161de3d9d2dc00b02a4d50d7531522d</span>
    </span></span></code></pre></td></tr></table>
    </div>
    </div><p>Apr√®s avoir converti les 2 parties les plus grandes au format d√©cimal et apr√®s multiples testes j'en viens √† la conclusion que ces deux-l√† ne sont pas  <strong>n</strong>, <strong>p</strong>, <strong>q</strong>, <strong>d</strong>, <strong>qinv</strong> <br> Ils en restent donc 2, exponent 1 <strong>(dp)</strong> et exponent2 <strong>(dq)</strong></p>
    <p> <img src="img8.png"
        width="1428"
        height="405"
        loading="lazy"
        class="gallery-image" 
        data-flex-grow="121"
        data-flex-basis="392px"></p>
        <p>Pla√ßons ces valeurs dans l‚Äôordre chronologiques au format ASN.1 pour les cl√©s priv√©es RSA PKCS1</p>
    <div class="highlight"><div class="chroma">
    <table class="lntable"><tr><td class="lntd">
    <pre tabindex="0" class="chroma"><code><span class="lnt">1
    </span></code></pre></td>
    <td class="lntd">
    <pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p"><span class="nt">PrivateKeyInfo ::= SEQUENCE {
        version Version, 
        privateKeyAlgorithm AlgorithmIdentifier , 
        privateKey PrivateKey, 
        attributes [0] Attributes OPTIONAL 
     } <br>
     
     RSAPrivateKey ::= SEQUENCE {
       version           Version, 
       modulus           INTEGER,  -- n 
       publicExponent    INTEGER,  -- e 
       privateExponent   INTEGER,  -- d 
       prime1            INTEGER,  -- p 
       prime2            INTEGER,  -- q 
       exponent1         INTEGER,  -- d mod (p-1) 
       exponent2         INTEGER,  -- d mod (q-1) 
       coefficient       INTEGER,  -- (inverse of q) mod p 
       otherPrimeInfos   OtherPrimeInfos OPTIONAL 
     }</span></span><span class="nt"></span>
    </span></span></code></pre></td></tr></table>
    </div>
    </div><p>Donc d'apr√®s notre hypoth√®se :</p>
    <div class="highlight"><div class="chroma">
    <table class="lntable"><tr><td class="lntd">
    <pre tabindex="0" class="chroma"><code><span class="lnt">1
    </span></code></pre></td>
    <td class="lntd">
    </span></span><span class="line"><span class="cl"><span class="p"><span class="k">exponent1</span> (dp) = 38a0a1ba87e4526b437ea772399e3b0f0dc5158bc99f6fb7c9362b3a4ff8e559219030679a344fea848fed94e73ba060ae53dab6b6e8c0fa2d9dc1c832c8d9f36f9090db0004f5ac19841020f7613600fbb5983260539725ef6433a58550ca6a7c99693f2d2f69a1551cc4d502ec7c75db5b120ead0014c2a3545f01799ecbc426d3a3b480474d3ba9140e30add05bb6c424f9a8cd7a1cbec8665ba96dd449e47772f12bce8b27881c856ff0f355e2b6112d04e45504e8e14abfb1fb9b45fbb89fd0e42f01f425168a2df5e6391c0b9e87fcca367c860a5da6b78465201adeef550240f8f8a0910ed46e25647c573866243e5250bf4f6496152d72a1c694e961 <br> <span class="nf">exponent2</span> (dq) =
        30683b9691f9bd4bc0de72fd512b905bdc61bed68d69fd7300fdc9b34da0ceff1fe258f0a3e298113d4ed3d442a52f69adaa0df579b33c12b1e65d97992eeae7b967371c5cf22fa3933893c60a28d85e5e58537c3405c5933ae3dc85acd45802c541b135418cabb555790afc209aa68b5935198e972cd8af6bec84a06d1f4b1d0dd19134a98bbcdc34e2887c58af3bbc8d64e6bfc71ce614f64e5fd5812661d3b53f0af3894fe41bc512bc12eca8b9bf8e07dfdef064553ccb2deeeead8f2d5c369b1dff5fc4698aad13f883709741b36606b7ab3479b4d10c007770c035878fbb91393f2fc70baa08d632aeae9b170f1161de3d9d2dc00b02a4d50d7531522d</span>
    </span></span></code></pre></td></tr></table>
    </div>
    </div><p>Calculons p et q √† partir de dp et dq (qui sont au format d√©cimal) et e (on va essayer de le guess (65537), on pourrait adapter notre script s‚Äôil √©tait difficilement guessable, on verra par la suite)</p>
    <div class="highlight"><div class="chroma">
        <table class="lntable"><tr><td class="lntd">
            <pre tabindex="0" class="chroma"><code><span class="lnt"> </span></code></pre>
        </td>
        <td class="lntd">
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">isPrime</span></span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">dp</span> <span class="o">=</span> <span class="mi">7148555547464038505019582073181987847221282336229090755303433935464041438728722315445920590295862691900510977361386320677860473810989959904375284918005822503490498629714441818111657597294112866124190516711142166703240642782046751441834698787320566407347275186885721002340336251213826539517538982749838281218351930912920837611810741859340764534985550700470528582527730023154106555023479350984164969387857980139298576959682474322435130483001430397565604367129022850910575247774674629721853252514890521369856402586485230434878874087329724012249237962607414595854323661609842458169031388035814172599136848735309198059873</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">dq</span> <span class="o">=</span> <span class="mi">6110837731088566352253221781036175367919253018523376282899460134677874564878401216507384943427927220524806674862457179446340613942066692858269570183978189888728064330003045868099468323724106389788209934294968725572772587551827772519479983428967827092576518158254621994207349871488516151148004300555859452598706382465317306648031526788407240594692980208094387779952221138768694912169842889075377451574509754595847039209814441119671744974531452517173371824184418025900649810707048375881108255850200714154032159719231171643502768691987934868963793270567688037612673362690122524924847642758845907369915127738132352553517</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span></span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="kn">for</span> <span class="n">kp</span> <span class="kn">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">    <span class="n">p_mul</span> <span class="o">=</span> <span class="n">dp</span> <span class="o">*</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">1</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">    <span class="kn">if</span> <span class="n">p_mul</span> <span class="o">%</span> <span class="n">kp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">        <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_mul</span> <span class="o">//</span> <span class="n">kp</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">        <span class="kn">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">p</span><span class="p">):</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">            <span class="kn">print</span><span class="p">(</span><span class="f">f" p = {p}"</span><span class="p">)</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="kn">for</span> <span class="n">kp</span> <span class="kn">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">    <span class="n">q_mul</span> <span class="o">=</span> <span class="n">dq</span> <span class="o">*</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">1</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">    <span class="kn">if</span> <span class="n">q_mul</span> <span class="o">%</span> <span class="n">kp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">        <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">q_mul</span> <span class="o">//</span> <span class="n">kp</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">        <span class="kn">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">q</span><span class="p">):</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line">            <span class="kn">print</span><span class="p">(</span><span class="f">f" q = {q}"</span><span class="p">)</span></span></code></pre>
            <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"></span></code></pre>
        </td></tr></table>
    </div></div>
    <p>On obtient :</p>
    <div class="highlight"><div class="chroma">
    <table class="lntable"><tr><td class="lntd">
    <pre tabindex="0" class="chroma"><code><span class="lnt">1
    </span></code></pre></td>
    <td class="lntd">
    <pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">p = 27928160054494825126883359185104497021957745482530308246218846487541393965422609501483117599178536705757602856830591672027716356014953740819853534883537859279359571308232213021376077731974025329787247326002868803530866289478807627376662930219053827757872928400770759900469664196470971679306167052904688610206088256109692574340699886094522544579990941058523817091691197766166955665965649253379983284576575168070891853246301658400562214394304902769910999309003563074821244114063120787366980423849083761491283401270371537824778347008126862747587380527892824463100137693646750830463416398074703632168681469780385032086433 <br>q = 26732926532431171018464681654346694151747152064279187734622649946357644039679312497579900342930115896905030041416518000759283413385036035635298900016512824960788408784153902747322265238095371501738863524723941350234483483771719960457189751951422767783605051100562923812453580437069813964207112865998889322806316012791502591668916772654151613834483268399831913219059389678358184263992723678081103534065726305783861385000574663083901418489811614953473818119055750895364187079921756185175902260440197864195501345138458934383568583657086528770261005244856456239304570734304956939857135035277116629817911202628261130051389</span><span class="nt"></span>
    </span></span></code></pre></td></tr></table>
    </div>
    </div>
    <p>De vue, e est bien √©gal √† <strong>65537</strong></p>
    <p> <img src="821806262643720223.webp"
        width="78"
        height="205"
        loading="lazy"
        class="gallery-image" 
        data-flex-grow="121"
        data-flex-basis="392px"></p>
        <p>Ils font chacun <strong>2048</strong> bits, ce qui laisse penser que n fait logiquement <strong>4096</strong> bits, calculons n</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
</span></span><span class="line"><span class="cl"><span class="p"><span class="kn">n</span> = p*q <br><span class="kn">n</span> = 746601450922789089705701592071438100012263055988877213418542096901953103990320756871218201853835552889188327878399402549085490835039405019252591371906221036608124660612934948482593109847370646445122484997259888120863223415509736830636722575982820947119186129993257666674107586854841834847405756800485744464756174972356173954375611223433403963056998599141462090264650068401164725710631985359015876368653083165946745975922577724441303533722820840105697268510100826492948453032033161252399099179547544007246001080416584100105247473305363551344150690341567675660359970065428347192396901139813867064701138951739369783468289764290429826235888619989991327112562893609863943986376182347162459797130440111268370692535397529183325882908847599129868019938058711957792910028347145036079894930337455505984145174522361274235240245860811261821228799970356319104830344703979957745939143449012204669522692263195710218649478591681518640247852325850341593372326983429776019189421551827593070008743583585358027882209610181872542698658120300156469150178676195719095318693026632009364447379486598325355292544152836281513323741301206284963525466743121619611486119473317531933236803796095843291412146793008748102253304239266662978781907066718860663179705437</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>n fait bien <strong>4096</strong> bits <br> Apr√®s reconstruction de la cl√© priv√©e, la voila avec la partie dont nous disposons, on pourrait d√©chiffrer le flag √† l'aide d'openssl mais nous allons le faire √† l'aide d'un simple script</p> 
    <p> <img src="img9.png"
        width="758"
        height="605"
        loading="lazy"
        class="gallery-image" 
        data-flex-grow="121"
        data-flex-basis="392px"></p>
<p>Maintenant nous pouvons mettre en place un script pour d√©chiffrer le fichier <strong>flag.enc</strong></p>
<div class="highlight"><div class="chroma">
    <table class="lntable"><tr><td class="lntd">
        <pre tabindex="0" class="chroma"><code><span class="lnt"> </span></code></pre>
    </td>
    <td class="lntd">
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span></span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">n</span> <span class="o">=</span> <span class="mi">746601450922789089705701592071438100012263055988877213418542096901953103990320756871218201853835552889188327878399402549085490835039405019252591371906221036608124660612934948482593109847370646445122484997259888120863223415509736830636722575982820947119186129993257666674107586854841834847405756800485744464756174972356173954375611223433403963056998599141462090264650068401164725710631985359015876368653083165946745975922577724441303533722820840105697268510100826492948453032033161252399099179547544007246001080416584100105247473305363551344150690341567675660359970065428347192396901139813867064701138951739369783468289764290429826235888619989991327112562893609863943986376182347162459797130440111268370692535397529183325882908847599129868019938058711957792910028347145036079894930337455505984145174522361274235240245860811261821228799970356319104830344703979957745939143449112204669522692263195710218649478591681518640247852325850341593372326983429776019189421551827593070008743583585358027882209610181872542698658120300156469150178676195719095318693026632009364447379486598325355292544152836281513323741301206284963525466743121619611486119473317531933236803796095843291412146793008748102253304239266662978781907066718860663179705437</span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span></span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">p</span> <span class="o">=</span> <span class="mi">27928160054494825126883359185104497021957745482530308246218846487541393965422609501483117599178536705757602856830591672027716356014953740819853534883537859279359571308232213021376077731974025329787247326002868803530866289478807627376662930219053827757872928400770759900469664196470971679306167052904688610206088256109692574340699886094522544579990941058523817091691197766166955665965649253379983284576575168070891853246301658400562214394304902769910999309003563074821244114063120787366980423849083761491283401270371537824778347008126862747587380527892824463100137693646750830463416398074703632168681469780385032086433</span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">q</span> <span class="o">=</span> <span class="mi">26732926532431171018464681654346694151747152064279187734622649946357644039679312497579900342930115896905030041416518000759283413385036035635298900016512824960788408784153902747322265238095371501738863524723941350234483483771719960457189751951422767783605051100562923812453580437069813964207112865998889322806316012791502591668916772654151613834483268399831913219059389678358184263992723678081103534065726305783861385000574663083901418489811614953473818119055750895364187079921756185175902260440197864195501345138458934383568583657086528770261005244856456239304570734304956939857135035277116629817911202628261130051389</span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">d</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">c</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s1">'flag.enc'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">).</span><span class="n">read</span><span class="p">()</span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">c</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="n">m</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></span></code></pre>
        <pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="kn">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span></span></code></pre>
    </td></tr></table>
</div></div>
<p>Ce qui donne :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">cryptostonk<span class="s2">{c0rRupTeD_PrIv&t_KeY}</span></span><span class="nt"></span>
</span></span></code></pre></td></tr></table>
</div>
</div>
<p>
</div>
<br>
</aside>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>
</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="ha.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>